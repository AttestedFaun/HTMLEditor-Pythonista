<!doctype html>
<!-- Built upon https://github.com/jsbain/CodeMirror/blob/master/demo/ed_cm.html -->
<html>
    <head>
        <title> CodeMirror: iPad Demo </title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=0, width=150"/>
        
        <!-- CODE MIRROR BASE -->        
        <script src="CodeMirror-5.3.0/lib/codemirror.js"></script>
        <link rel="stylesheet" href="CodeMirror-5.3.0/lib/codemirror.css">
        
        <!-- ADDONS -->
        <script src="CodeMirror-5.3.0/addon/mode/loadmode.js"></script>
        <script src="CodeMirror-5.3.0/addon/edit/closebrackets.js"></script>
        <script src="CodeMirror-5.3.0/addon/edit/closetag.js"></script>
        
        <!-- MISC -->
        <script src="JSONStringify/stringify.js" type="text/javascript" rel="javascript"></script>
        <script src="main.js" type="text/javascript" rel="javascript"></script>
        
        <style type="text/css">
            .CodeMirror {
                overflow: hidden;
                position:relative;
                min-height:100%;
                height:100%;
            }
            .CodeMirror-scroll {
                overflow: scroll;
                -webkit-overflow-scrolling: touch;
            }
            body {
                top: 0px;
                left: 0px;
                position:relative;
                overflow: hidden;
                margin: 0;
                padding: 0;
                min-height:99%;
                height:100%;
            }
            html {
                padding:0px;
                margin:0px;
                height:100%;
            }
        </style>
    </head>
    <body>
        <form>
            <textarea id="code" name="code"></textarea>
        </form>
        <script>
            var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
                                                    value: "",
                                                    mode: "htmlmixed",
                                                    theme: "default",
                                                    indentUnit: 4,
                                                    smartIndent: true,
                                                    tabSize: 4,
                                                    indentWithTabs: false,
                                                    electricChars: true,
                                                    //spceialChars: \[]\,
                                                    //specialCharPlaceholder: function() {},
                                                    rtlMoveVissually: false,
                                                    keyMap: "default",
                                                    //extraKeys: {},
                                                    lineWrapping: false,
                                                    lineNumbers: true,
                                                    firstLineNumber: 1,
                                                    //lineNumberFormatter: function(line) {return ""},
                                                    //gutters: {},
                                                    fixedGutter: true,
                                                    scrollbarStyle: "native",
                                                    coverGutterNextToScrollbar: false,
                                                    inputStyle: "contenteditable",
                                                    readOnly: false,
                                                    showCursorWhenSelecting: true,
                                                    lineWiseCopyCut: true,
                                                    undoDepth: 250,
                                                    historyEventDelay: 1250,
                                                    //tabIndex: 0,
                                                    autofocus: true,
                                                    dragDrop: true,
                                                    cursorBlinkRate: 530,
                                                    cursorScrollMargin: 0,
                                                    cursorHeight: 1,
                                                    resetSelctionOnContextMenu: true,
                                                    workTime: 200,
                                                    workDelay: 300,
                                                    pollInterval: 100,
                                                    flattenSpans: true,
                                                    addModeClass: true,
                                                    maxHighlightLength: 10000,
                                                    viewportMargin: 100,
                                                    matchBrackets: true,
                                                    autoCloseBrackets: true,
                                                    autoCloseTags: true,
            });
            CodeMirror.modeURL = "CodeMirror-5.3.0/mode/%N/%N.js";
            CodeMirror.autoLoadMode(editor, editor.options.mode);
            
            editor.on("change", function(e, a) {
                send_to_python("ios-save", "SAVE");
                console.debug("saving file...");
            });
            
            console.log("Editor setup")
            
        </script>
    </body>
</html>
